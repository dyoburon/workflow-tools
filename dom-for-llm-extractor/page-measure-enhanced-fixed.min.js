(function(){if(document.getElementById('page-measure-overlay')){document.getElementById('page-measure-overlay').remove();return}var startX,startY,box;var vw=window.innerWidth;var vh=window.innerHeight;var overlay=document.createElement('div');overlay.id='page-measure-overlay';Object.assign(overlay.style,{position:'fixed',top:'0',left:'0',width:'100vw',height:'100vh',cursor:'crosshair',zIndex:'2147483647',background:'transparent'});function createBox(){box=document.createElement('div');Object.assign(box.style,{position:'fixed',border:'2px solid #0066ff',background:'rgba(0,102,255,0.1)',pointerEvents:'none',zIndex:'2147483647'});overlay.appendChild(box)}function showToast(msg,duration){duration=duration||2000;var t=document.createElement('div');Object.assign(t.style,{position:'fixed',top:'20px',right:'20px',background:'#333',color:'#fff',padding:'16px 24px',borderRadius:'8px',fontSize:'13px',fontFamily:'monospace',zIndex:'2147483647',boxShadow:'0 4px 12px rgba(0,0,0,0.3)',maxWidth:'400px',whiteSpace:'pre-wrap',lineHeight:'1.4'});t.textContent=msg;document.body.appendChild(t);setTimeout(function(){t.remove()},duration)}function getShortSelector(el){var selector=el.tagName.toLowerCase();if(el.id)selector+='#'+el.id;if(el.className&&typeof el.className==='string'){var classes=el.className.trim().split(/\s+/).filter(function(c){return c&&c.indexOf(':')===-1});if(classes.length>0){selector+='.'+classes.slice(0,3).join('.')}}return selector}function getSelector(el){if(el.id)return'#'+el.id;var path=[];while(el&&el.nodeType===Node.ELEMENT_NODE){var selector=el.tagName.toLowerCase();if(el.id){selector='#'+el.id;path.unshift(selector);break}else if(el.className&&typeof el.className==='string'){var classes=el.className.trim().split(/\s+/).filter(function(c){return c&&c.indexOf(':')===-1});if(classes.length>0){selector+='.'+classes.slice(0,2).join('.')}}path.unshift(selector);el=el.parentElement}return path.slice(-4).join(' > ')}function getText(el){var text=el.textContent||'';var cleaned=text.replace(/\s+/g,' ').trim();if(cleaned.length>60){return cleaned.substring(0,60)+'...'}return cleaned}function getPositionInParent(el){var parent=el.offsetParent||el.parentElement;if(!parent)return null;var elRect=el.getBoundingClientRect();var parentRect=parent.getBoundingClientRect();var leftPct=((elRect.left-parentRect.left)/parentRect.width*100).toFixed(1);var topPct=((elRect.top-parentRect.top)/parentRect.height*100).toFixed(1);return{left:leftPct,top:topPct,parentSelector:getShortSelector(parent)}}function getElementsInRect(rect){var elements=[];var seen=new Set();var step=10;for(var x=rect.left;x<=rect.right;x+=step){for(var y=rect.top;y<=rect.bottom;y+=step){var elsAtPoint=document.elementsFromPoint(x,y);for(var j=0;j<elsAtPoint.length;j++){var el=elsAtPoint[j];if(el===overlay||el===box||el===document.body||el===document.documentElement)continue;if(seen.has(el))continue;seen.add(el);var elRect=el.getBoundingClientRect();var overlapLeft=Math.max(rect.left,elRect.left);var overlapRight=Math.min(rect.right,elRect.right);var overlapTop=Math.max(rect.top,elRect.top);var overlapBottom=Math.min(rect.bottom,elRect.bottom);if(overlapRight>overlapLeft&&overlapBottom>overlapTop){var overlapArea=(overlapRight-overlapLeft)*(overlapBottom-overlapTop);var elArea=elRect.width*elRect.height;var coverage=elArea>0?overlapArea/elArea:0;if(coverage>0.3){elements.push({el:el,rect:elRect,area:elArea,coverage:coverage})}}}}}elements.sort(function(a,b){return a.area-b.area});return elements}function buildOutput(rect,elements){var lines=[];var leftPct=(rect.left/vw*100).toFixed(1);var topPct=(rect.top/vh*100).toFixed(1);var widthPct=((rect.right-rect.left)/vw*100).toFixed(1);var heightPct=((rect.bottom-rect.top)/vh*100).toFixed(1);lines.push('SELECTION');lines.push('Position: '+leftPct+'% left, '+topPct+'% top');lines.push('Size: '+widthPct+'% x '+heightPct+'%');lines.push('');if(elements.length===0){lines.push('No elements found in selection')}else{var primary=elements[0];lines.push('PRIMARY ELEMENT');lines.push('Tag: '+getShortSelector(primary.el));var text=getText(primary.el);if(text){lines.push('Text: '+text)}lines.push('Selector: '+getSelector(primary.el));var posInParent=getPositionInParent(primary.el);if(posInParent){lines.push('In parent ('+posInParent.parentSelector+'): '+posInParent.left+'% left, '+posInParent.top+'% top')}if(elements.length>1){lines.push('');lines.push('OTHER ELEMENTS ('+(elements.length-1)+'):');for(var i=1;i<Math.min(elements.length,6);i++){var el=elements[i];var elText=getText(el.el);var textPart=elText?' '+elText.substring(0,30)+(elText.length>30?'...':''):'';lines.push('- '+getShortSelector(el.el)+textPart)}if(elements.length>6){lines.push('  ... and '+(elements.length-6)+' more')}}}return lines.join(String.fromCharCode(10))}function onMouseDown(e){startX=e.clientX;startY=e.clientY;createBox();box.style.left=startX+'px';box.style.top=startY+'px';box.style.width='0';box.style.height='0'}function onMouseMove(e){if(!box)return;var l=Math.min(startX,e.clientX);var t=Math.min(startY,e.clientY);var w=Math.abs(e.clientX-startX);var h=Math.abs(e.clientY-startY);Object.assign(box.style,{left:l+'px',top:t+'px',width:w+'px',height:h+'px'})}function onMouseUp(e){if(!box)return;var rect={left:Math.min(startX,e.clientX),top:Math.min(startY,e.clientY),right:Math.max(startX,e.clientX),bottom:Math.max(startY,e.clientY)};overlay.style.display='none';var elements=getElementsInRect(rect);overlay.style.display='block';var output=buildOutput(rect,elements);navigator.clipboard.writeText(output).then(function(){showToast('Copied!'+String.fromCharCode(10)+String.fromCharCode(10)+output.substring(0,200)+(output.length>200?'...':''),3000)}).catch(function(){showToast('Failed to copy')});overlay.remove()}overlay.addEventListener('mousedown',onMouseDown);overlay.addEventListener('mousemove',onMouseMove);overlay.addEventListener('mouseup',onMouseUp);document.addEventListener('keydown',function(e){if(e.key==='Escape')overlay.remove()});document.body.appendChild(overlay)})();
